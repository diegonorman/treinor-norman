const workoutData = {
    1: {
        name: "DIA 1 - Quadríceps",
        exercises: [
            {
                name: "MOBILIDADE TORNOZELO",
                sets: "2x15",
                rest: "15 seg",
                details: "",
                video: "https://www.youtube.com/shorts/PPoaqzaHtwc?feature=share"
            },
            {
                name: "CADEIRA ABDUTORA",
                sets: "3x8-12",
                rest: "60 seg",
                details: "1 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/1ebbyK2hgtynVITTnDWwo_dorwmtNlT8n/view?usp=drive_link"
            },
            {
                name: "AGACHAMENTO SMITH",
                sets: "4x6-10",
                rest: "60 seg",
                details: "Progressão de carga.",
                video: "https://drive.google.com/file/d/1ORuuq6XyExfFtA8cPyc93UMphPPGcrOn/view?usp=drive_link"
            },
            {
                name: "AGACHAMENTO HACK",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Não descolar a lombar. Força na ponta dos pés.",
                video: "https://drive.google.com/file/d/12J_l0zIqQ--aTiWuOo1rTThA4sX9NaHB/view?usp=drive_link"
            },
            {
                name: "LEG PRESS",
                sets: "4x12-15",
                rest: "60 seg",
                details: "Não descolar a lombar. Força na ponta dos pés.",
                video: "https://drive.google.com/file/d/1Mr4tetd9oDUkhEryWjvdsUJhiU3CM-WX/view?usp=drive_link"
            },
            {
                name: "CADEIRA EXTENSORA",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Progressão de carga.",
                video: "https://drive.google.com/file/d/1hftxb2lGCRkW7EwXxqlz3rNSEteMg4_F/view?usp=drive_link"
            }
        ]
    },
    2: {
        name: "DIA 2 - Peito/Abdômen",
        exercises: [
            {
                name: "ALONGAMENTO PEITORAL MENOR",
                sets: "1x20 seg",
                rest: "-",
                details: "",
                video: "https://www.youtube.com/shorts/1yElQu1suCg?feature=share"
            },
            {
                name: "ABDOMINAL BANCO DECLINADO",
                sets: "4x15",
                rest: "60 seg",
                details: "Usar anilha no peito.",
                video: "https://drive.google.com/file/d/1Kec-G4bbX8nUbpB4rm-RzrI5A1Y94bdn/view?usp=drive_link"
            },
            {
                name: "ABDOMINAL ELEVAÇÃO DE PERNAS NA BARRA",
                sets: "4x15",
                rest: "60 seg",
                details: "Usar halter entre os pés.",
                video: "https://grandeatleta.com.br/wp-content/uploads/2018/06/Abdominal-infra-na-barra-fixa.gif"
            },
            {
                name: "CRUCIFIXO INCLINADO NO CROSS",
                sets: "4x15",
                rest: "60 seg",
                details: "1 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/1pF3qRnE1XVj66opbcRmGagNtzup-08Bo/view?usp=drive_link"
            },
            {
                name: "SUPINO INCLINADO (Máquina ou Guiada)",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Progressão de carga.",
                video: "https://drive.google.com/file/d/17qu6Web_4SsNLLXa-A5oysDG1Jol3kbd/view?usp=drive_link"
            },
            {
                name: "VOADOR",
                sets: "4x8-12",
                rest: "60 seg",
                details: "1 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/18RxXp_n6gc05h6BKvr3o8TC7WgGG9mUa/view?usp=drive_link"
            },
            {
                name: "CROSSOVER",
                sets: "4x8-12",
                rest: "60 seg",
                details: "1 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/16kQayKcudGSUQJKNcTvm5LH3_rodjJMa/view?usp=drive_link"
            }
        ]
    },
    3: {
        name: "DIA 3 - Costas/Bíceps",
        exercises: [
            {
                name: "ALONGAMENTO ESCÁPULA/OMBRO",
                sets: "2x15 seg",
                rest: "15 seg",
                details: "",
                video: "https://www.youtube.com/shorts/AwA7fzu8ajE?feature=share"
            },
            {
                name: "REMADA LIVRE PRONADA",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Progressão de carga.",
                video: "https://drive.google.com/file/d/1lGyP8xFPyMcHUghCRIVhsINioBuUI-id/view?usp=drive_link"
            },
            {
                name: "REMADA TRIÂNGULO NA MÁQUINA",
                sets: "4x10-15",
                rest: "60 seg",
                details: "Progressão de carga.",
                video: ""
            },
            {
                name: "PUXADA ALTA PRONADA",
                sets: "4x8-12 (até a falha)",
                rest: "60 seg",
                details: "Após falhar, fazer +5 repetições 'roubadas' (com balanço).",
                video: "https://drive.google.com/file/d/1qPfDgL8lDNDl2IC5EsHHSbaHE1OODK0p/view?usp=drive_link"
            },
            {
                name: "PULLDOWN COM CORDA",
                sets: "4x8-12",
                rest: "60 seg",
                details: "1 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/1iJDC_64ANTqetf3GK-hd1qQPQlMNrAYU/view?usp=drive_link"
            },
            {
                name: "MEIO TERRA",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Progressão de carga.",
                video: "https://drive.google.com/file/d/1-GRvZLsDLQo-rgrLQyeXyZgldpwh_GZa/view?usp=drive_link"
            },
            {
                name: "ROSCA DIRETA CROSS PEGADA ABERTA",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Na última série, fazer +2 drops de 6 reps.",
                video: "https://drive.google.com/file/d/1t-3UE-WN-HnD-hESwFkUw5HWplBVSWVM/view?usp=drive_link"
            },
            {
                name: "ROSCA DIRETA NA PUXADA ALTA",
                sets: "4x8-12",
                rest: "60 seg",
                details: "1 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/1S4DZr0UmCl6Qj0h6DOo1-x3BIuLMoMfg/view?usp=drive_link"
            }
        ]
    },
    4: {
        name: "DIA 4 - Posterior/Glúteo",
        exercises: [
            {
                name: "ALONGAMENTO GLÚTEO",
                sets: "2x30 seg",
                rest: "15 seg",
                details: "",
                video: "https://www.youtube.com/shorts/zByNfWpvlOI?feature=share"
            },
            {
                name: "ALONGAMENTO POSTERIOR",
                sets: "2x15 seg",
                rest: "15 seg",
                details: "",
                video: "https://www.youtube.com/shorts/MOb1N4IDl3Q?feature=share"
            },
            {
                name: "MESA FLEXORA",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Tronco levantado. Progressão de carga.",
                video: "https://drive.google.com/file/d/1MjRTM3Du2dKSi11VlMt6zii7xpbs5ign/view?usp=drive_link"
            },
            {
                name: "CADEIRA FLEXORA",
                sets: "4x8-12",
                rest: "60 seg",
                details: "3 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/1uXTVSWfkAXfw5UoKuw1Cn-nbBYF5roxg/view?usp=drive_link"
            },
            {
                name: "STIFF COM BARRA",
                sets: "4x8-12",
                rest: "60 seg",
                details: "Focar na amplitude. Progressão de carga.",
                video: "https://drive.google.com/file/d/10JhCI1PEQV3oTtNjPcZ3lnXRDpPmUN_i/view?usp=drive_link"
            },
            {
                name: "FLEXOR DEITADO COM HALTER",
                sets: "4x12-15",
                rest: "60 seg",
                details: "1 seg de isometria no pico.",
                video: "https://drive.google.com/file/d/1evImvQ8vSG8CfjahJIsDL6IHKOvR8uxq/view?usp=drive_link"
            },
            {
                name: "CADEIRA ABDUTORA",
                sets: "4x8-12",
                rest: "60 seg",
                details: "1 seg de isometria no pico. Progressão de carga.",
                video: "https://drive.google.com/file/d/1ebbyK2hgtynVITTnDWwo_dorwmtNlT8n/view?usp=drive_link"
            },
            {
                name: "ELEVAÇÃO PÉLVICA",
                sets: "4x6-10",
                rest: "60 seg",
                details: "Fase negativa (descida) de 5 segundos. Progressão de carga.",
                video: "https://drive.google.com/file/d/12Dit2g3NPfTTPwV-DbVygifMtkrA0piC/view?usp=drive_link"
            }
        ]
    },
    5: {
        name: "DIA 5 - Ombros/Tríceps/Panturrilha",
        exercises: [
            {
                name: "ALONGAMENTO ESCÁPULA/OMBRO",
                sets: "2x15 seg",
                rest: "15 seg",
                details: "",
                video: "https://www.youtube.com/shorts/AwA7fzu8ajE?feature=share"
            },
            {
                name: "PANTURRILHA EM PÉ",
                sets: "4x15-20",
                rest: "60 seg",
                details: "Máxima amplitude. Progressão de carga.",
                video: "https://drive.google.com/file/d/1Bwd3QzvLUK7Ax7LABhKzsoA8O8LsFjkg/view?usp=drive_link"
            },
            {
                name: "DESENVOLVIMENTO (Máquina ou Guiada)",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Progressão de carga.",
                video: "https://drive.google.com/file/d/1V3ggri0GrchEAvD2LXiNj2wFQHbV-ipR/view?usp=drive_link"
            },
            {
                name: "ELEVAÇÃO LATERAL EM PÉ",
                sets: "4x12-15",
                rest: "60 seg",
                details: "Progressão de carga.",
                video: "https://drive.google.com/file/d/1nXdJ7O4nJsp1295Lw6s6oNHl3ehmAaHM/view?usp=drive_link"
            },
            {
                name: "ELEVAÇÃO LATERAL PARCIAL NO CROSS",
                sets: "4x12-15",
                rest: "60 seg",
                details: "Progressão de carga.",
                video: "https://drive.google.com/file/d/19mQxNpqBqERFg8DNSptsMndzwPyZqhzy/view?usp=drive_link"
            },
            {
                name: "CRUCIFIXO INVERTIDO NO VOADOR",
                sets: "4x12-15",
                rest: "60 seg",
                details: "Progressão de carga.",
                video: "https://drive.google.com/file/d/18RxXp_n6gc05h6BKvr3o8TC7WgGG9mUa/view?usp=drive_link"
            },
            {
                name: "ELEVAÇÃO FRONTAL NO CROSS COM CORDA",
                sets: "4x12-15",
                rest: "60 seg",
                details: "Progressão de carga.",
                video: "https://drive.google.com/file/d/1oLAvzfdiKrUqa-y1BzetP79VRxrjrTPR/view?usp=drive_link"
            },
            {
                name: "TRÍCEPS TESTA CORDA BANCO INCLINADO",
                sets: "4x15-20/10-15/8-12/6-10",
                rest: "60 seg",
                details: "Pirâmide. Progressão de carga.",
                video: "https://drive.google.com/file/d/1Pfd0v-Bdc4_aKiPVfjmyf9F57z48jKgd/view?usp=drive_link"
            },
            {
                name: "TRÍCEPS COM BARRA NO CROSS",
                sets: "4x12-15",
                rest: "60 seg",
                details: "Progressão de carga.",
                video: "https://drive.google.com/file/d/135z_bY-JxYk5Jjld7x5gXpghoBQOEnae/view?usp=drive_link"
            }
        ]
    }
};

let currentDay = 1;
let completedExercises = JSON.parse(localStorage.getItem('completedExercises')) || {};
let timerInterval;

document.addEventListener('DOMContentLoaded', function() {
    showDay(1);
    
    // Registrar Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js');
    }
});

function showDay(day) {
    currentDay = day;
    
    document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector(`[onclick="showDay(${day})"]`).classList.add('active');
    
    renderExercises(day);
    updateProgress();
}

function renderExercises(day) {
    const container = document.getElementById('workout-container');
    const workout = workoutData[day];
    
    container.innerHTML = `<h2>${workout.name}</h2>`;
    
    workout.exercises.forEach((exercise, index) => {
        const exerciseId = `${day}-${index}`;
        const isCompleted = completedExercises[exerciseId] || false;
        
        const exerciseCard = document.createElement('div');
        exerciseCard.className = `exercise-card ${isCompleted ? 'completed' : ''}`;
        
        exerciseCard.innerHTML = `
            <div class="exercise-header">
                <div class="exercise-name">${exercise.name}</div>
                <div class="check-btn ${isCompleted ? 'checked' : ''}" onclick="toggleExercise('${exerciseId}')">
                    ${isCompleted ? '✓' : ''}
                </div>
            </div>
            <div class="exercise-details">
                <div class="sets-info">${exercise.sets}</div>
                <div class="rest-info">Pausa: ${exercise.rest}</div>
                <div>${exercise.details}</div>
                ${exercise.video ? `<button class="video-link" onclick="openVideo('${exercise.video}')">📹 Ver Vídeo</button>` : ''}
                ${exercise.rest !== '-' && exercise.rest !== '' ? `<button class="timer-btn" onclick="startTimer('${exercise.rest}')">⏱️ Cronômetro</button>` : ''}
            </div>
        `;
        
        container.appendChild(exerciseCard);
    });
}

function toggleExercise(exerciseId) {
    completedExercises[exerciseId] = !completedExercises[exerciseId];
    localStorage.setItem('completedExercises', JSON.stringify(completedExercises));
    
    renderExercises(currentDay);
    updateProgress();
}

function updateProgress() {
    const workout = workoutData[currentDay];
    const totalExercises = workout.exercises.length;
    let completedCount = 0;
    
    workout.exercises.forEach((exercise, index) => {
        const exerciseId = `${currentDay}-${index}`;
        if (completedExercises[exerciseId]) {
            completedCount++;
        }
    });
    
    const progressPercent = (completedCount / totalExercises) * 100;
    
    document.getElementById('progress').style.width = progressPercent + '%';
    document.getElementById('progress-count').textContent = completedCount;
    document.getElementById('total-count').textContent = totalExercises;
}

function startTimer(restTime) {
    const seconds = parseInt(restTime.replace(/[^0-9]/g, '')) || 60;
    let timeLeft = seconds;
    
    document.getElementById('timer-display').textContent = timeLeft;
    document.getElementById('timer-modal').classList.remove('hidden');
    
    timerInterval = setInterval(() => {
        timeLeft--;
        document.getElementById('timer-display').textContent = timeLeft;
        
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            document.getElementById('timer-display').textContent = "FIM!";
            setTimeout(() => {
                closeTimer();
            }, 2000);
        }
    }, 1000);
}

function openVideo(url) {
    let embedUrl = url;
    
    if (url.includes('youtube.com/watch')) {
        const videoId = url.split('v=')[1]?.split('&')[0];
        embedUrl = `https://www.youtube.com/embed/${videoId}`;
    } else if (url.includes('youtube.com/shorts')) {
        const videoId = url.split('/shorts/')[1]?.split('?')[0];
        embedUrl = `https://www.youtube.com/embed/${videoId}`;
    } else if (url.includes('drive.google.com')) {
        const fileId = url.split('/d/')[1]?.split('/')[0];
        embedUrl = `https://drive.google.com/file/d/${fileId}/preview`;
    }
    
    document.getElementById('video-frame').src = embedUrl;
    document.getElementById('video-modal').classList.remove('hidden');
}

function closeVideo() {
    document.getElementById('video-frame').src = '';
    document.getElementById('video-modal').classList.add('hidden');
}

function closeTimer() {
    clearInterval(timerInterval);
    document.getElementById('timer-modal').classList.add('hidden');
}

document.querySelector('h1').addEventListener('click', function() {
    if (confirm('Deseja resetar todo o progresso?')) {
        completedExercises = {};
        localStorage.removeItem('completedExercises');
        renderExercises(currentDay);
        updateProgress();
    }
});
